<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="The Ansible 2.5 open source project release includes new Infoblox Network Identity Operating System (NIOS) enablement. For network professionals, this means that existing networking Ansible Playbooks can utilize existing Infoblox infrastructure for IP Address Management (IPAM), using Infoblox for tracking inventory and more.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Infoblox Integration in Ansible 2.5 | Ansible Collaborative</title>
<link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
<!-- Red Hat fonts --><link rel="stylesheet" href="https://static.redhat.com/libs/redhat/redhat-font/2.0.0/webfonts/red-hat-font.css">
<!-- Font Awesome --><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
<!-- Fork Awesome --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css" integrity="sha256-XoaMnoYC5TH6/+ihMEnospgm0J1PM/nioxbOUdnM8HY=" crossorigin="anonymous">
<!-- Sass compiled css  --><link rel="stylesheet" href="../../assets/css/main.css">
<link rel="stylesheet" href="../../assets/css/redhat-footer.css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://ansible.com/blog/infoblox-integration-in-ansible-2.5/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Sean Cavanaugh">
<link rel="prev" href="../getting-started-ldap-authentication-in-ansible-tower/" title="Getting Started with LDAP Authentication in Ansible Tower" type="text/html">
<link rel="next" href="../getting-started-ansible-towers-api/" title="Getting Started with Ansible Tower's API" type="text/html">
<meta property="og:site_name" content="Ansible Collaborative">
<meta property="og:title" content="Infoblox Integration in Ansible 2.5">
<meta property="og:url" content="https://ansible.com/blog/infoblox-integration-in-ansible-2.5/">
<meta property="og:description" content="The Ansible 2.5 open source project release includes new Infoblox Network Identity Operating System (NIOS) enablement. For network professionals, this means that existing networking Ansible Playbooks ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-03-26T00:00:00Z">
</head>
<body id="top">

<div class="global-container" id="content" role="main">
<!-- Start menubar -->
<nav class="navbar navbar-expand-lg static-top mb-4 navbar-padding full-width-bg   navbar-dark   bg-pool   "><div class="masthead">
    <!-- This keeps the margins nice -->
    <a class="navbar-brand" href="../../">
        <img src="../../images/ansible_logo-small-15.png" alt="Ansible community logo" id="logo" class="d-inline-block align-top" width="50" height="50"></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon nav-toggle-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="bs-navbar">
      <ul class="navbar-nav mr-auto"></ul>
<ul class="navbar-nav navbar-right">
<li class="nav-item dropdown">
	        <a href="#" class="nav-link nav-link-color dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		    <i class=""></i> Documentation
                </a>
		<div class="dropdown-menu dropdown-menu-border">
	    
                    <a href="https://docs.ansible.com/" class="dropdown-item">
		        <i class=""></i> Project documentation
                    </a>
                    <a href="https://access.redhat.com/documentation/en-us/red_hat_ansible_automation_platform/" class="dropdown-item">
		        <i class=""></i> Ansible Automation Platform documentation
                    </a>
            </div>
                 </li>
<li class="nav-item">
		     <a href="https://galaxy.ansible.com/" target="_blank" class="nav-link nav-link-color">
		         <i class=""></i> Galaxy
		     </a>
		 </li>
                 <li class="nav-item">
		     <a href="https://forum.ansible.com/" target="_blank" class="nav-link nav-link-color">
		         <i class=""></i> Forum
		     </a>
		 </li>
            <li class="nav-item dropdown">
	        <a href="#" class="nav-link nav-link-color dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		    <i class=""></i> Resources
                </a>
		<div class="dropdown-menu dropdown-menu-border">
	    
                    <a href="../../how-ansible-works/" class="dropdown-item">
		        <i class=""></i> How Ansible works
                    </a>
                    <a href="../../ecosystem/" class="dropdown-item">
		        <i class=""></i> Ansible ecosystem
                    </a>
                    <a href="../archive.html" class="dropdown-item">
		        <i class=""></i> Blog
                    </a>
                    <a href="../../faq/" class="dropdown-item">
		        <i class=""></i> Frequently asked questions
                    </a>
                    <a href="../../ansible-community-training/" class="dropdown-item">
		        <i class=""></i> Ansible community training
                    </a>
                    <a href="../../contact-us/" class="dropdown-item">
		        <i class=""></i> Contact us
                    </a>
            </div>
                 </li>
<li class="nav-item">
		     <a href="https://www.redhat.com/en/technologies/management/ansible?sc_cid=7015Y000003szaKQAQ" target="_blank" class="nav-link nav-link-color">
		         <i class=""></i> Ansible Automation Platform
		     </a>
		 </li>

        
      </ul>
</div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav><!-- End default Menubar --><div class="body-content center-band">
        <!--Body content-->
        
  <article class="post-text h-entry hentry postpage ansible-content" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Infoblox Integration in Ansible 2.5</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/sean-cavanaugh/">Sean Cavanaugh</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2018-03-26T00:00:00Z" itemprop="datePublished" title="2018-03-26 00:00">2018-03-26 00:00</time></a>
            </p>
                    <p class="sourceline"><a href="index.md" class="sourcelink">Source</a></p>

        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
<h2>Infoblox Integration in Ansible 2.5</h2>
<p>The Ansible 2.5 open source project release includes the following
Infoblox Network Identity Operating System (NIOS) enablement:</p>
<ul>
<li>Five modules</li>
<li>A lookup plugin (for querying Infoblox NIOS objects)</li>
<li>A dynamic inventory script</li>
</ul>
<p>For network professionals, this means that existing networking Ansible
Playbooks can utilize existing Infoblox infrastructure for IP Address
Management (IPAM), using Infoblox for tracking inventory and more. For
more information on Infoblox terminology, documentation and examples,
refer to the <a href="https://www.infoblox.com/">Infoblox website</a></p>
<p>Let's elaborate on each of these Ansible 2.5 additions. All of the
following examples (and many more) are provided in the network
automation community project, under the <code>infoblox_ansible</code>
<a href="https://github.com/network-automation/infoblox_ansible">GitHub repository</a>. The
integrations for Ansible require that the control node (where Ansible is
being executed from) have the infoblox-client installed. It can be
<a href="https://pypi.python.org/pypi/infoblox-client">found here</a> and installed
with pip issuing the <code>pip install infoblox-client</code> command.</p>
<h3>Ansible Infoblox Modules</h3>
<p>There are <a href="http://docs.ansible.com/ansible/latest/modules/list_of_net_tools_modules.html#nios">five new
modules</a>
included with Ansible 2.5. They can be currently found in the
development branch of the documentation:</p>
<ul>
<li>
<a href="http://docs.ansible.com/ansible/latest/modules/nios_host_record_module.html">nios_host_record</a> -
    configure host records</li>
<li>
<a href="http://docs.ansible.com/ansible/latest/modules/nios_network_module.html">nios_network</a> -
    configure networking objects</li>
<li>
<a href="http://docs.ansible.com/ansible/latest/modules/nios_network_view_module.html">nios_network_view</a> -
    configure networking views</li>
<li>
<a href="http://docs.ansible.com/ansible/latest/modules/nios_dns_view_module.html">nios_dns_view</a> -
    configure DNS views</li>
<li>
<a href="http://docs.ansible.com/ansible/latest/modules/nios_zone_module.html">nios_zone</a> -
    configure DNS zones</li>
</ul>
<p>Here is an example playbook on configuring a IPv4 network using the
nios_network module:</p>
<div class="code"><pre class="code literal-block"><span class="x">---</span>
<span class="x">- hosts: localhost</span>
<span class="x">  connection: local</span>
<span class="x">  tasks:</span>
<span class="x">    - name: set dhcp options for a network</span>
<span class="x">      nios_network:</span>
<span class="x">        network: 192.168.100.0/24</span>
<span class="x">        comment: sean put a comment here</span>
<span class="x">        options:</span>
<span class="x">          - name: domain-name</span>
<span class="x">            value: ansible.com</span>
<span class="x">        state: present</span>
<span class="x">        provider: "</span><span class="cp">{{</span><span class="nv">nios_provider</span><span class="cp">}}</span><span class="x">"</span>
</pre></div>

<p>Since this playbook did not specify the
<code>network_view</code> parameter it will default to the default view. To run the playbook use the
<code>ansible-playbook</code> command:</p>
<div class="code"><pre class="code literal-block"><span class="n">SEANs</span><span class="o">-</span><span class="n">MacBook</span><span class="o">-</span><span class="nl">Pro</span><span class="p">:</span><span class="n">infoblox_ansible</span><span class="w"> </span><span class="n">sean</span><span class="err">$</span><span class="w"> </span><span class="n">ansible</span><span class="o">-</span><span class="n">playbook</span><span class="w">  </span><span class="n">configure_network</span><span class="p">.</span><span class="n">yml</span>

<span class="n">PLAY</span><span class="w"> </span><span class="o">[</span><span class="n">localhost</span><span class="o">]</span><span class="w"> </span><span class="o">***************************************************************************************</span>

<span class="n">TASK</span><span class="w"> </span><span class="o">[</span><span class="n">set dhcp options for a network</span><span class="o">]</span><span class="w"> </span><span class="o">***************************************************************</span>
<span class="nl">changed</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">localhost</span><span class="o">]</span>

<span class="n">PLAY</span><span class="w"> </span><span class="n">RECAP</span><span class="w"> </span><span class="o">******************************************************************************************</span>
<span class="n">localhost</span><span class="w">                  </span><span class="err">:</span><span class="w"> </span><span class="n">ok</span><span class="o">=</span><span class="mi">1</span><span class="w">    </span><span class="n">changed</span><span class="o">=</span><span class="mi">1</span><span class="w">    </span><span class="n">unreachable</span><span class="o">=</span><span class="mi">0</span><span class="w">    </span><span class="n">failed</span><span class="o">=</span><span class="mi">0</span>
</pre></div>

<p>We can login to the web https GUI website and look under <strong>Data Management -&gt; IPAM</strong> where we will see the new network listed:</p>
<p><img alt="Ansible-Infoblox-Image-1" src="../../images/posts/archive/Ansible-Infoblox-Image-1.png"></p>
<p>The modules can keep state (where applicable) so when we re-run the
playbook instead of saying <strong>changed</strong> it will just say <strong>OK</strong> and not
perform any changes to Infoblox. This is also referred to as
<em>idempotency</em> (referred to in the <a href="http://docs.ansible.com/ansible/latest/glossary.html">Ansible Docs
glossar</a>y).</p>
<div class="code"><pre class="code literal-block"><span class="n">SEANs</span><span class="o">-</span><span class="n">MacBook</span><span class="o">-</span><span class="nl">Pro</span><span class="p">:</span><span class="n">infoblox_ansible</span><span class="w"> </span><span class="n">sean</span><span class="err">$</span><span class="w"> </span><span class="n">ansible</span><span class="o">-</span><span class="n">playbook</span><span class="w">  </span><span class="n">configure_network</span><span class="p">.</span><span class="n">yml</span>

<span class="n">PLAY</span><span class="w"> </span><span class="o">[</span><span class="n">localhost</span><span class="o">]</span><span class="w"> </span><span class="o">***************************************************************************************</span>

<span class="n">TASK</span><span class="w"> </span><span class="o">[</span><span class="n">set dhcp options for a network</span><span class="o">]</span><span class="w"> </span><span class="o">***************************************************************</span>
<span class="nl">ok</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">localhost</span><span class="o">]</span>

<span class="n">PLAY</span><span class="w"> </span><span class="n">RECAP</span><span class="w"> </span><span class="o">******************************************************************************************</span>
<span class="n">localhost</span><span class="w">                  </span><span class="err">:</span><span class="w"> </span><span class="n">ok</span><span class="o">=</span><span class="mi">1</span><span class="w">    </span><span class="n">changed</span><span class="o">=</span><span class="mi">0</span><span class="w">    </span><span class="n">unreachable</span><span class="o">=</span><span class="mi">0</span><span class="w">    </span><span class="n">failed</span><span class="o">=</span><span class="mi">0</span>
</pre></div>

<h4>Ansible Infoblox Lookup Plugin</h4>
<p>Next let's look at the <a href="http://docs.ansible.com/ansible/latest/plugins/lookup.html">new lookup
plugin</a> for
Infoblox. The Ansible documentation for the lookup plugin can be <a href="http://docs.ansible.com/ansible/latest/plugins/lookup/nios.html">found
here</a>.
The lookup plugin allows us to query different InfoBlox NIOS objects,
such as network views, dns views, host records, and more. In my Infoblox
IPAM tab (<strong>Data Management-&gt;IPAM</strong>) I have four top of rack leaf
switches, and two spine switches defined. I can see them under the list
view for managed nodes:</p>
<p><img alt="Ansible-Infoblox-Image-2" src="../../images/posts/archive/Ansible-Infoblox-Image-2.png"></p>
<p>Let's look at an Ansible Playbook snippet focused on grabbing
information about a host record:</p>
<div class="code"><pre class="code literal-block"><span class="x"> - name: fetch host leaf01</span>
<span class="x">      set_fact:</span>
<span class="x">        host: "</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">'nios'</span><span class="o">,</span> <span class="s1">'record:host'</span><span class="o">,</span> <span class="nv">filter</span><span class="o">={</span><span class="s1">'name'</span><span class="o">:</span> <span class="s1">'leaf01'</span><span class="o">},</span> <span class="nv">provider</span><span class="o">=</span><span class="nv">nios_provider</span><span class="o">)</span> <span class="cp">}}</span><span class="x">"</span>
</pre></div>

<p>We will set the result of the lookup plugin (specified by the keyword
nios above) to the variable host. We only want the information for
leaf01, so we will filter based on the name. For the full playbook
checkout the get_host_record.yml stored on the <a href="https://github.com/network-automation/infoblox_ansible">network automation
community</a>.</p>
<p>Run the playbook with the ansible-playbook command:</p>
<div class="code"><pre class="code literal-block"><span class="n">SEANs</span><span class="o">-</span><span class="n">MacBook</span><span class="o">-</span><span class="nl">Pro</span><span class="p">:</span><span class="n">infoblox_ansible</span><span class="w"> </span><span class="n">sean</span><span class="err">$</span><span class="w"> </span><span class="n">ansible</span><span class="o">-</span><span class="n">playbook</span><span class="w"> </span><span class="n">get_host_record</span><span class="p">.</span><span class="n">yml</span>

<span class="n">PLAY</span><span class="w"> </span><span class="o">[</span><span class="n">localhost</span><span class="o">]</span><span class="w"> </span><span class="o">***************************************************************************************</span>

<span class="n">TASK</span><span class="w"> </span><span class="o">[</span><span class="n">fetch host leaf01</span><span class="o">]</span><span class="w"> </span><span class="o">******************************************************************************</span>
<span class="nl">ok</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">localhost</span><span class="o">]</span>

<span class="n">TASK</span><span class="w"> </span><span class="o">[</span><span class="n">check the leaf01 return variable</span><span class="o">]</span><span class="w"> </span><span class="o">*************************************************************</span>
<span class="nl">ok</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">localhost</span><span class="o">]</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="o">&lt;</span><span class="n">SNIPPET</span><span class="p">,</span><span class="w"> </span><span class="n">REST</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="k">OUTPUT</span><span class="w"> </span><span class="n">REMOVED</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="n">BREVITY</span><span class="o">&gt;</span>
<span class="w">    </span><span class="ss">"host"</span><span class="err">:</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="ss">"ipv4addrs"</span><span class="err">:</span><span class="w"> </span><span class="o">[</span>
<span class="n">            {</span>
<span class="n">                "configure_for_dhcp": false,</span>
<span class="n">                "host": "leaf01",</span>
<span class="n">                "ipv4addr": "192.168.1.11"</span>
<span class="n">            }</span>
<span class="n">        </span><span class="o">]</span><span class="p">,</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>

<span class="n">TASK</span><span class="w"> </span><span class="o">[</span><span class="n">debug specific variable (ipv4 address)</span><span class="o">]</span><span class="w"> </span><span class="o">******************************************************</span>
<span class="nl">ok</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">localhost</span><span class="o">]</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="ss">"host.ipv4addrs[0].ipv4addr"</span><span class="err">:</span><span class="w"> </span><span class="ss">"192.168.1.11"</span>
<span class="err">}</span>

<span class="n">TASK</span><span class="w"> </span><span class="o">[</span><span class="n">fetch host leaf02</span><span class="o">]</span><span class="w"> </span><span class="o">******************************************************************************</span>
<span class="nl">ok</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">localhost</span><span class="o">]</span>

<span class="n">TASK</span><span class="w"> </span><span class="o">[</span><span class="n">check the leaf02 return variable</span><span class="o">]</span><span class="w"> </span><span class="o">*************************************************************</span>
<span class="nl">ok</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">localhost</span><span class="o">]</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="o">&lt;</span><span class="n">SNIPPET</span><span class="p">,</span><span class="w"> </span><span class="n">REST</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="k">OUTPUT</span><span class="w"> </span><span class="n">REMOVED</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="n">BREVITY</span><span class="o">&gt;</span>

<span class="w">    </span><span class="ss">"host"</span><span class="err">:</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="ss">"ipv4addrs"</span><span class="err">:</span><span class="w"> </span><span class="o">[</span>
<span class="n">            {</span>
<span class="n">                "configure_for_dhcp": false,</span>
<span class="n">                "host": "leaf02",</span>
<span class="n">                "ipv4addr": "192.168.1.12"</span>
<span class="n">            }</span>
<span class="n">        </span><span class="o">]</span><span class="p">,</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>

<span class="n">PLAY</span><span class="w"> </span><span class="n">RECAP</span><span class="w"> </span><span class="o">******************************************************************************************</span>
<span class="n">localhost</span><span class="w">                  </span><span class="err">:</span><span class="w"> </span><span class="n">ok</span><span class="o">=</span><span class="mi">5</span><span class="w">    </span><span class="n">changed</span><span class="o">=</span><span class="mi">0</span><span class="w">    </span><span class="n">unreachable</span><span class="o">=</span><span class="mi">0</span><span class="w">    </span><span class="n">failed</span><span class="o">=</span><span class="mi">0</span>
</pre></div>

<p>The above playbook shows us how we can query Infoblox to grab specific
information about Infoblox objects (in this case, specific hosts). These
facts can be used through an Ansible play and allow Infoblox to act as a
single source of truth for information that may be changing. While the
Ansible modules allow you to configure Infoblox, the lookup plugin
allows you to grab information from Infoblox to use in subsequent tasks.
To read more about Ansible variables, facts and the set_fact module,
refer to the <a href="http://docs.ansible.com/ansible/latest/playbooks_variables.html">Ansible variables
documentation</a>.</p>
<h4>Ansible Infoblox Dynamic Inventory</h4>
<p>Ansible dynamic inventory scripts allow import of inventory from another
source like Cobbler, AWS or in this case Infoblox NIOS. You can read
more about dynamic inventory on the Ansible dynamic inventory
<a href="http://docs.ansible.com/ansible/latest/intro_dynamic_inventory.html">documentation
page</a>.</p>
<p>There are two files that need to be located under the
<code>contrib/inventory/</code> in the Ansible project:</p>
<ul>
<li>
<a href="https://raw.githubusercontent.com/ansible/ansible/devel/contrib/inventory/infoblox.yaml">infoblox.yaml</a> -
    specifies the provider arguments and optional filters</li>
<li>
<a href="https://raw.githubusercontent.com/ansible/ansible/devel/contrib/inventory/infoblox.py">infoblox.py</a> -
    python script that retrieves inventory</li>
</ul>
<p>Update the infoblox.yaml with your login information to the NIOS
instance. This includes the username, password and an IP address or
hostname. Make sure the infoblox.yaml file is located in <code>/etc/ansible/infoblox.yaml</code>.</p>
<p>To test your setup the python script infoblox.py can be run by executing
<code>python infoblox.py</code> on the command line:</p>
<div class="code"><pre class="code literal-block"><span class="p">[</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="nd">@ip</span><span class="o">-</span><span class="mi">172</span><span class="o">-</span><span class="mi">16</span><span class="o">-</span><span class="mi">103</span><span class="o">-</span><span class="mi">218</span> <span class="n">infoblox</span><span class="p">]</span><span class="err">$</span> <span class="n">python</span> <span class="n">infoblox</span><span class="o">.</span><span class="n">py</span>
<span class="p">{</span>
    <span class="s2">" "</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"hosts"</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">"leaf01"</span><span class="p">,</span>
            <span class="s2">"leaf02"</span><span class="p">,</span>
            <span class="s2">"leaf03"</span><span class="p">,</span>
            <span class="s2">"leaf04"</span><span class="p">,</span>
            <span class="s2">"spine01"</span><span class="p">,</span>
            <span class="s2">"spine02"</span>
        <span class="p">]</span>
    <span class="p">},</span>
<span class="o">&lt;</span><span class="n">SNIPPET</span><span class="p">,</span> <span class="n">REST</span> <span class="n">OF</span> <span class="n">OUTPUT</span> <span class="n">REMOVED</span> <span class="n">FOR</span> <span class="n">BREVITY</span><span class="o">&gt;</span>
</pre></div>

<p>For this playbook we will create a small debug playbook to print out the
inventory_hostname for each host we grab using the infoblox python
dynamic inventory script.</p>
<div class="code"><pre class="code literal-block"><span class="o">---</span>
<span class="o">-</span><span class="w"> </span><span class="n">hosts</span><span class="p">:</span><span class="w"> </span><span class="n">all</span>
<span class="w">  </span><span class="n">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="bp">false</span>
<span class="w">  </span><span class="n">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">hosts</span>
<span class="w">      </span><span class="n">debug</span><span class="p">:</span>
<span class="w">      </span><span class="k">var</span><span class="p">:</span><span class="w"> </span><span class="n">inventory_hostname</span>
<span class="w">      </span><span class="n">delegate_to</span><span class="p">:</span><span class="w"> </span><span class="n">localhost</span>
</pre></div>

<p>To grab the inventory for a playbook use the
<code>-i</code> parameter and specify
the infoblox.py python script. Run the playbook with the
ansible-playbook command:</p>
<div class="code"><pre class="code literal-block"><span class="p">[</span><span class="n">sean</span><span class="nd">@rhel</span><span class="o">-</span><span class="mi">7</span><span class="p">]</span><span class="err">$</span>  <span class="n">ansible</span><span class="o">-</span><span class="n">playbook</span> <span class="o">-</span><span class="n">i</span> <span class="n">infoblox</span><span class="o">.</span><span class="n">py</span> <span class="n">debug</span><span class="o">.</span><span class="n">yml</span>

<span class="n">PLAY</span> <span class="p">[</span><span class="nb">all</span><span class="p">]</span> <span class="o">***********************************************************************************************</span>

<span class="n">TASK</span> <span class="p">[</span><span class="nb">list</span> <span class="nb">all</span> <span class="n">hosts</span><span class="p">]</span> <span class="o">************************************************************************************</span>
<span class="n">ok</span><span class="p">:</span> <span class="p">[</span><span class="n">leaf01</span> <span class="o">-&gt;</span> <span class="n">localhost</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s2">"inventory_hostname"</span><span class="p">:</span> <span class="s2">"leaf01"</span>
<span class="p">}</span>
<span class="n">ok</span><span class="p">:</span> <span class="p">[</span><span class="n">leaf03</span> <span class="o">-&gt;</span> <span class="n">localhost</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s2">"inventory_hostname"</span><span class="p">:</span> <span class="s2">"leaf03"</span>
<span class="p">}</span>
<span class="n">ok</span><span class="p">:</span> <span class="p">[</span><span class="n">leaf02</span> <span class="o">-&gt;</span> <span class="n">localhost</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s2">"inventory_hostname"</span><span class="p">:</span> <span class="s2">"leaf02"</span>
<span class="p">}</span>
<span class="n">ok</span><span class="p">:</span> <span class="p">[</span><span class="n">leaf04</span> <span class="o">-&gt;</span> <span class="n">localhost</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s2">"inventory_hostname"</span><span class="p">:</span> <span class="s2">"leaf04"</span>
<span class="p">}</span>
<span class="n">ok</span><span class="p">:</span> <span class="p">[</span><span class="n">spine01</span> <span class="o">-&gt;</span> <span class="n">localhost</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s2">"inventory_hostname"</span><span class="p">:</span> <span class="s2">"spine01"</span>
<span class="p">}</span>
<span class="n">ok</span><span class="p">:</span> <span class="p">[</span><span class="n">spine02</span> <span class="o">-&gt;</span> <span class="n">localhost</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s2">"inventory_hostname"</span><span class="p">:</span> <span class="s2">"spine02"</span>
<span class="p">}</span>

<span class="n">PLAY</span> <span class="n">RECAP</span> <span class="o">******************************************************************************************</span>
<span class="n">leaf01</span>                       <span class="p">:</span> <span class="n">ok</span><span class="o">=</span><span class="mi">1</span>    <span class="n">changed</span><span class="o">=</span><span class="mi">0</span>    <span class="n">unreachable</span><span class="o">=</span><span class="mi">0</span>    <span class="n">failed</span><span class="o">=</span><span class="mi">0</span>
<span class="n">leaf02</span>                       <span class="p">:</span> <span class="n">ok</span><span class="o">=</span><span class="mi">1</span>    <span class="n">changed</span><span class="o">=</span><span class="mi">0</span>    <span class="n">unreachable</span><span class="o">=</span><span class="mi">0</span>    <span class="n">failed</span><span class="o">=</span><span class="mi">0</span>
<span class="n">leaf03</span>                       <span class="p">:</span> <span class="n">ok</span><span class="o">=</span><span class="mi">1</span>    <span class="n">changed</span><span class="o">=</span><span class="mi">0</span>    <span class="n">unreachable</span><span class="o">=</span><span class="mi">0</span>    <span class="n">failed</span><span class="o">=</span><span class="mi">0</span>
<span class="n">leaf04</span>                       <span class="p">:</span> <span class="n">ok</span><span class="o">=</span><span class="mi">1</span>    <span class="n">changed</span><span class="o">=</span><span class="mi">0</span>    <span class="n">unreachable</span><span class="o">=</span><span class="mi">0</span>    <span class="n">failed</span><span class="o">=</span><span class="mi">0</span>
<span class="n">spine01</span>                    <span class="p">:</span> <span class="n">ok</span><span class="o">=</span><span class="mi">1</span>    <span class="n">changed</span><span class="o">=</span><span class="mi">0</span>    <span class="n">unreachable</span><span class="o">=</span><span class="mi">0</span>    <span class="n">failed</span><span class="o">=</span><span class="mi">0</span>
<span class="n">spine02</span>                    <span class="p">:</span> <span class="n">ok</span><span class="o">=</span><span class="mi">1</span>    <span class="n">changed</span><span class="o">=</span><span class="mi">0</span>    <span class="n">unreachable</span><span class="o">=</span><span class="mi">0</span>    <span class="n">failed</span><span class="o">=</span><span class="mi">0</span>
</pre></div>

<h4>More Information</h4>
<p>For more information on Ansible networking check out the <a href="../../overview/networking">Ansible
Networking microsite</a>. Infoblox NIOS can now
utilize Ansible Playbook that are already configuring Cisco IOS, NX-OS,
IOS-XR, Juniper JunOS, Arista EOS and <a href="http://docs.ansible.com/ansible/latest/list_of_network_modules.html">much
more</a>.</p>
</div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../getting-started-ldap-authentication-in-ansible-tower/" rel="prev" title="Getting Started with LDAP Authentication in Ansible Tower">Previous post</a>
            </li>
            <li class="next">
                <a href="../getting-started-ansible-towers-api/" rel="next" title="Getting Started with Ansible Tower's API">Next post</a>
            </li>
        </ul></nav></aside></article><!--End of body content-->
</div>
        <div class="content-slim redhat-footer">
      <div class="footer-left">
        <ul class="footer-left-links">
<li>
            <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a>
          </li>
          <li>
            <a href="https://www.redhat.com/en/about/privacy-policy" target="_blank">Privacy policy</a>
          </li>
          <li>
            <a href="https://docs.ansible.com/ansible/latest/community/code_of_conduct.html" target="_blank">Code of conduct</a>
          </li>
        </ul>
</div>
      <div class="footer-right">
        <span class="redhat">Powered by</span>
        <span class="redhat-logo">
          <a href="https://www.redhat.com/en/technologies/management/ansible" target="_blank">
            <img src="../../assets/images/redhat_reversed.svg" alt="Red Hat logo." width="96" height="28"></a>
        </span>
      </div>
    </div>

</div>

            <script src="../../assets/js/jquery.min.js"></script><script src="../../assets/js/popper.min.js"></script><script src="../../assets/js/bootstrap.min.js"></script><script src="../../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script><script src="../../assets/js/clipboard.min.js" type="text/javascript"></script><script src="../../assets/js/clipboard.js" type="text/javascript"></script>
</body>
</html>
