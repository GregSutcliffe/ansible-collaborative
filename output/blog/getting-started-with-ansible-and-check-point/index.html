<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Check Point has a certified Ansible Content Collection of modules to help enable organizations to automate their response and remediation practices, and to embrace the DevOps model to accelerate application deployment with operational efficiency.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Getting started with Ansible and Check Point | Ansible Collaborative</title>
<link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
<!-- Red Hat fonts --><link rel="stylesheet" href="https://static.redhat.com/libs/redhat/redhat-font/2.0.0/webfonts/red-hat-font.css">
<!-- Font Awesome --><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
<!-- Fork Awesome --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css" integrity="sha256-XoaMnoYC5TH6/+ihMEnospgm0J1PM/nioxbOUdnM8HY=" crossorigin="anonymous">
<!-- Sass compiled css  --><link rel="stylesheet" href="../../assets/css/main.css">
<link rel="stylesheet" href="../../assets/css/redhat-footer.css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://ansible.com/blog/getting-started-with-ansible-and-check-point/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Sumit Jaiswal">
<link rel="prev" href="../migrating-existing-content-into-a-dedicated-ansible-collection/" title="Migrating existing content into a dedicated Ansible collection" type="text/html">
<link rel="next" href="../bullhorn-1/" title="Bullhorn #1" type="text/html">
<meta property="og:site_name" content="Ansible Collaborative">
<meta property="og:title" content="Getting started with Ansible and Check Point">
<meta property="og:url" content="https://ansible.com/blog/getting-started-with-ansible-and-check-point/">
<meta property="og:description" content="Check Point has a certified Ansible Content Collection of modules to help enable organizations to automate their response and remediation practices, and to embrace the DevOps model to accelerate appli">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-04-13T00:00:00Z">
</head>
<body id="top">

<div class="global-container" id="content" role="main">
<!-- Start menubar -->
<nav class="navbar navbar-expand-lg static-top mb-4 navbar-padding full-width-bg   navbar-dark   bg-pool   "><div class="masthead">
    <!-- This keeps the margins nice -->
    <a class="navbar-brand" href="../../">
        <img src="../../images/ansible_logo-small-15.png" alt="Ansible community logo" id="logo" class="d-inline-block align-top" width="50" height="50"></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon nav-toggle-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="bs-navbar">
      <ul class="navbar-nav mr-auto"></ul>
<ul class="navbar-nav navbar-right">
<li class="nav-item dropdown">
	        <a href="#" class="nav-link nav-link-color dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		    <i class=""></i> Documentation
                </a>
		<div class="dropdown-menu dropdown-menu-border">
	    
                    <a href="https://docs.ansible.com/" class="dropdown-item">
		        <i class=""></i> Project documentation
                    </a>
                    <a href="https://access.redhat.com/documentation/en-us/red_hat_ansible_automation_platform/" class="dropdown-item">
		        <i class=""></i> Ansible Automation Platform documentation
                    </a>
            </div>
                 </li>
<li class="nav-item">
		     <a href="https://galaxy.ansible.com/" target="_blank" class="nav-link nav-link-color">
		         <i class=""></i> Galaxy
		     </a>
		 </li>
                 <li class="nav-item">
		     <a href="https://forum.ansible.com/" target="_blank" class="nav-link nav-link-color">
		         <i class=""></i> Forum
		     </a>
		 </li>
            <li class="nav-item dropdown">
	        <a href="#" class="nav-link nav-link-color dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		    <i class=""></i> Resources
                </a>
		<div class="dropdown-menu dropdown-menu-border">
	    
                    <a href="../../how-ansible-works/" class="dropdown-item">
		        <i class=""></i> How Ansible works
                    </a>
                    <a href="../../ecosystem/" class="dropdown-item">
		        <i class=""></i> Ansible ecosystem
                    </a>
                    <a href="../archive.html" class="dropdown-item">
		        <i class=""></i> Blog
                    </a>
                    <a href="../../faq/" class="dropdown-item">
		        <i class=""></i> Frequently asked questions
                    </a>
                    <a href="../../ansible-community-training/" class="dropdown-item">
		        <i class=""></i> Ansible community training
                    </a>
                    <a href="../../contact-us/" class="dropdown-item">
		        <i class=""></i> Contact us
                    </a>
            </div>
                 </li>
<li class="nav-item">
		     <a href="https://www.redhat.com/en/technologies/management/ansible?sc_cid=7015Y000003szaKQAQ" target="_blank" class="nav-link nav-link-color">
		         <i class=""></i> Ansible Automation Platform
		     </a>
		 </li>

        
      </ul>
</div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav><!-- End default Menubar --><div class="body-content center-band">
        <!--Body content-->
        
  <article class="post-text h-entry hentry postpage ansible-content" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Getting started with Ansible and Check Point</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/sumit-jaiswal/">Sumit Jaiswal</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2020-04-13T00:00:00Z" itemprop="datePublished" title="2020-04-13 00:00">2020-04-13 00:00</time></a>
            </p>
                    <p class="sourceline"><a href="index.md" class="sourcelink">Source</a></p>

        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
<h2>Getting started with Ansible and Check Point</h2>
<p>The scale and complexity of modern infrastructures require not only that
you be able to define a security policy for your systems, but also be
able to apply that security policy programmatically or make changes as a
response to external events.  As such, the proper automation tooling is
a necessary building block to allow you to apply the appropriate actions
in a fast, simple and consistent manner.</p>
<p><a href="https://cloud.redhat.com/ansible/automation-hub/check_point/mgmt">Check Point has a certified Ansible Content Collection of modules</a>
to help enable organizations to automate their response and remediation
practices, and to embrace the DevOps model to accelerate application
deployment with operational efficiency. The modules, based on Check
Point security management APIs are also available on Ansible Galaxy,
in the upstream version of
<a href="https://galaxy.ansible.com/check_point/mgmt">Check Point Collection for the Management Server</a>. </p>
<p>The operational flow is exactly the same for the API as it is for the
Check Point security management GUI SmartConsole, <em>i.e.</em> Login &gt; Get
Session &gt; Do changes &gt; Publish &gt; Logout. </p>
<p>Security professionals can leverage these modules to automate various
tasks for the identification, search, and response to security events. 
Additionally, in combination with other modules that are part of
Ansible security automation,
existing Check Point infrastructures can be integrated in orchestrated
processes involving multiple security technologies.  </p>
<p>DevOps professionals can consume the same modules in automated workflows
to support the deployment and maintenance of both physical and
virtualized next-generation firewalls.</p>
<p>To better understand how these new modules can be consumed, I'll provide
a series of examples based on the code in the security automation
community project, under the <strong>Ansible security automation</strong>
<a href="https://github.com/ansible-security/ansible-security-playbooks/tree/master/playbooks/checkpoint">Sample Plays GH repo</a>. 
The pre-requisite for the integrations to work and function as expected
is that Check Point R80 versions are supported by this integration given
this
<a href="https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&amp;solutionid=sk114661">hotfix</a>
is applied.</p>
<h3>Ansible Check Point Modules</h3>
<p><code>cp_mgmt_*</code> modules have been released with Ansible 2.9. They can be
currently found in the '<em>latest</em>' branch of the
<a href="https://docs.ansible.com/ansible/latest/modules/list_of_network_modules.html#check-point">documentation</a>.</p>
<p>There are quite a few modules available to manage the Check Point
appliance, in the Check Point Mgmt Collection they are structured in two
categories:</p>
<ul>
<li>
<code>cp_mgmt_*</code>: All these modules use the aforementioned API to <strong>post</strong> API objects on the Check Point appliance.</li>
<li>
<code>cp_mgmt_*_facts</code>: All the facts modules use the same API to get facts from the Check Point appliance.</li>
</ul>
<p>As an example, if we look at the modules dedicated to <em>host objects</em>
this is reflected in the following way:</p>
<ul>
<li>
<a href="https://docs.ansible.com/ansible/latest/modules/cp_mgmt_host_module.html">cp_mgmt_host</a> - Manages host objects on Check Point devices including creating, updating and removing objects.</li>
<li>
<a href="https://docs.ansible.com/ansible/latest/modules/cp_mgmt_host_facts_module.html">cp_mgmt_host_facts</a> - Gets host objects facts on Check Point devices.</li>
</ul>
<p>There are also a total of nine
<a href="https://docs.ansible.com/ansible/2.8/modules/list_of_network_modules.html#checkpoint">checkpoint_*</a>
modules which were introduced with
<strong>Ansible</strong> <strong>2.8</strong>, but these
modules are deprecated and it's encouraged and advisable to use the
latest <code>cp_mgmt_*</code> modules
that were introduced in
<strong>Ansible 2.9</strong> unless required.</p>
<h3>cp_mgmt_* modules example: How to perform host configuration</h3>
<p>Here is an example of how to use the  <strong>cp_mgmt_host</strong> module to
configure a <strong>host</strong>:</p>
<div class="code"><pre class="code literal-block"><span class="nn">---</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check_point</span>
<span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">httpapi</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create host object</span>
<span class="w">      </span><span class="nt">cp_mgmt_host</span><span class="p">:</span>
<span class="w">        </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dark green</span>
<span class="w">        </span><span class="nt">ipv4_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.0.2.2</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">New CP_MGMT Host 1</span>
<span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">        </span><span class="nt">auto_publish_session</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>

<p>When the module argument <strong>auto_publish_session</strong> is set to <em>True</em>, you
will  make Ansible run to take effect on your Check Point appliance
immediately.  You'll then have to <strong>publish</strong> the changes, and that's
what <strong>auto_publish_session</strong> achieves.  Note that by default, the value
of <strong>auto_publish_session</strong> is <strong>False</strong>. This module argument is
available if the user wants to publish the changes at <strong>task</strong> level.</p>
<p>However, if we want to publish the changes at the very end of the play
run, after running <strong>"n"</strong> number of tasks, we can just run the
available <strong>cp_mgmt_publish</strong> module at the end of the play, and all
changes done will take effect on your Check Point appliance.</p>
<p>To run the playbook use the ansible-playbook command:</p>
<p><img alt="Checkpoint blog one" src="../../images/posts/archive/checkpoint-blog-one.png"></p>
<p>To check if this has effectively changed the Check Point configuration
as expected, login to the Check Point SmartConsole and look under
<strong>Network objects -&gt; Hosts</strong> where we will see the new host listed:</p>
<p><img alt="checkpoint blog two" src="../../images/posts/archive/checkpoint-blog-two.png"></p>
<p>The modules can keep state (where applicable) so when we re-run the
playbook instead of \"<strong>changed\"</strong> it will just say <strong>OK</strong> without
performing any changes to the Check Point appliance. This is also
referred to as <strong><em>idempotency</em></strong> (also see the <a href="http://docs.ansible.com/ansible/latest/glossary.html">Ansible
Docs</a>).</p>
<p><img alt="checkpoint blog three" src="../../images/posts/archive/checkpoint-blog-three.png"></p>
<h3>Example: How to collect hosts facts</h3>
<p>Check Point <strong>facts</strong> modules allow us to query different Check Point
objects, such as network, address, dns domain, host records, and more.</p>
<p>Let's look at an Ansible Playbook snippet focused on grabbing
information about an <strong>host</strong> configured via the previous example
playbook:</p>
<div class="code"><pre class="code literal-block"><span class="x">---</span>
<span class="x">- hosts: check_point</span>
<span class="x">  connection: httpapi</span>
<span class="x">  tasks:</span>
<span class="x">    - name: collect-host facts</span>
<span class="x">      cp_mgmt_host_facts:</span>
<span class="x">        name: New CP_MGMT Host 1</span>
<span class="x">      register: cp_host</span>
<span class="x">    - name: display host facts</span>
<span class="x">      debug:</span>
<span class="x">        msg: "</span><span class="cp">{{</span> <span class="nv">cp_host</span> <span class="cp">}}</span><span class="x">"</span>
</pre></div>

<p>Run the playbook with the ansible-playbook command as:</p>
<p><img alt="checkpoint blog four" src="../../images/posts/archive/checkpoint-blog-four.jpg"></p>
<p>Play output: All of the host facts related to queried host name <em>i.e.</em> <strong>"New CP_MGMT Host 1"</strong></p>
<p>The above playbook shows how we can query Check Point to collect
specific information about objects (in this case, hosts). These facts
can be then used through an Ansible play and allow an appliance, or a
group of appliances, to act as a single source of truth for information
that may be changing. To read more about Ansible variables, facts and
the set_fact module, refer to the <a href="http://docs.ansible.com/ansible/latest/playbooks_variables.html">Ansible variables
documentation</a>.</p>
<h3>How to use Check Point modules in response and remediation scenarios</h3>
<p>Ansible security automation supports interoperability between the many security technologies used by SOCs or security teams as part of their response and remediation activities. </p>
<p>To help security professionals adopt Ansible as the common automation
language for security, we have written a number of roles that can be
immediately consumed to accelerate productivity in these scenarios.</p>
<p>An example of these roles is
<a href="https://github.com/ansible-security/acl_manager">acl_manager</a>, which
can be used to automate tasks such as blocking and unblocking IP and
URLs on supported technologies, like Check Point NGFW. </p>
<h4>How to Block an IP in Check Point using the acl_manager role</h4>
<div class="code"><pre class="code literal-block"><span class="o">---</span>
<span class="o">-</span><span class="w"> </span><span class="n">hosts</span><span class="p">:</span><span class="w"> </span><span class="n">checkpoint</span>
<span class="w">  </span><span class="n">connection</span><span class="p">:</span><span class="w"> </span><span class="n">httpapi</span>
<span class="w">  </span><span class="n">tasks</span><span class="p">:</span><span class="w"> </span>
<span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">include_role</span><span class="p">:</span>
<span class="w">       </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">acl_manager</span>
<span class="w">       </span><span class="n">tasks_from</span><span class="p">:</span><span class="w"> </span><span class="n">blacklist_ip</span>
<span class="w">     </span><span class="n">vars</span><span class="p">:</span>
<span class="w">       </span><span class="n">source_ip</span><span class="p">:</span><span class="w"> </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.2</span>
<span class="w">       </span><span class="n">destination_ip</span><span class="p">:</span><span class="w"> </span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.12</span>
<span class="w">       </span><span class="n">ansible_network_os</span><span class="p">:</span><span class="w"> </span><span class="n">checkpoint</span>
</pre></div>

<p>Roles can be used to abstract common security tasks to seamlessly
support specific use cases without getting into underlying module
functionalities.</p>
<p>The Check Point management API and other Check Point APIs are defined
in the <a href="https://sc1.checkpoint.com/documents/latest/api_reference/index.html">Check Point API Reference</a>.</p>
</div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../migrating-existing-content-into-a-dedicated-ansible-collection/" rel="prev" title="Migrating existing content into a dedicated Ansible collection">Previous post</a>
            </li>
            <li class="next">
                <a href="../bullhorn-1/" rel="next" title="Bullhorn #1">Next post</a>
            </li>
        </ul></nav></aside></article><!--End of body content-->
</div>
        <div class="content-slim redhat-footer">
      <div class="footer-left">
        <ul class="footer-left-links">
<li>
            <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a>
          </li>
          <li>
            <a href="https://www.redhat.com/en/about/privacy-policy" target="_blank">Privacy policy</a>
          </li>
          <li>
            <a href="https://docs.ansible.com/ansible/latest/community/code_of_conduct.html" target="_blank">Code of conduct</a>
          </li>
        </ul>
</div>
      <div class="footer-right">
        <span class="redhat">Powered by</span>
        <span class="redhat-logo">
          <a href="https://www.redhat.com/en/technologies/management/ansible" target="_blank">
            <img src="../../assets/images/redhat_reversed.svg" alt="Red Hat logo." width="96" height="28"></a>
        </span>
      </div>
    </div>

</div>

            <script src="../../assets/js/jquery.min.js"></script><script src="../../assets/js/popper.min.js"></script><script src="../../assets/js/bootstrap.min.js"></script><script src="../../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script><script src="../../assets/js/clipboard.min.js" type="text/javascript"></script><script src="../../assets/js/clipboard.js" type="text/javascript"></script>
</body>
</html>
